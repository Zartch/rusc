{% extends "base.html" %}
{% load staticfiles %}
{% load i18n %}
{% block title %}{% trans 'Perfil Usuario' %}{% endblock %}
{% block headers %}
    <link href="{% static 'css/django-admin-widgets.css' %}" rel="stylesheet">
    <script src="{% static 'js/django-admin.multiselect.js' %}"></script>
    <script src="{% static 'js/m2m.js' %}"></script>
    <script src="{% static 'js/jquery.formset.js' %}"></script>
    <script src="{% static 'js/custom-formset.js' %}"></script>

    <link href="{% static 'css/select2.min.css' %}" rel="stylesheet"/>
    <script src="{% static 'js/select2.js' %}"></script>


    <style>
        .select2 {
            min-width: 200px;
        }
        p{
            padding: 10px;
        }
    </style>
{% endblock %}
{#todo Les subscripcions disponibles només han de ser las de la cela#}
{% block content %}
    <script>
        $(document).ready(function () {
            $(".etiquetes").select2({tags: true, allowClear: true, placeholder: "Etiqueta personal"});
            $("#id_mailConf").select2({tags: true});
        });

    </script>
    <h3><b>Configuración de perfil de usuario de la red: {{ cela_context.pregunta }}</b></h3><br>

    <form action="" enctype="multipart/form-data" method="post">{% csrf_token %}
        <input type="submit" class="btn btn-primary btn-lg" value="Grabar"/>
        {% if form.instance.avatar %}
            <img src="{{ form.instance.avatar.url }}" alt="avatar" height="120" width="120"/>
        {% else %}
            <img src="{% static "images/pulpo.gif" %}" alt="avatar" height="120" width="120">
        {% endif %}


        <table >
            <thead>
                <tr>
                    <td> {%  trans 'Etiquetas Personales' %}
                        <img title="{% trans 'Las etiquetas personales sirven para permitir a la red interconectar facetas importantes de tu persona a la materia trabajada' %}"
                             src="{% static 'images/icons/info.svg' %}" style="height: 15px;width: 15px"/>
                    </td>
                    <td>
                        {% trans 'Visible' %}
                        <img title="{% trans 'Permite ver a otros usuarios la etiqueta personal' %}"
                             src="{% static 'images/icons/info.svg' %}" style="height: 15px;width: 15px"/>
                    </td>
                    <td>
                        Delete
                    </td>
                </tr>
            </thead>
            <tbody class="">
                {% for userInfo_form in info_formset %}
                    <tr class="userInfo_form">
                        <td >{{ userInfo_form.etq }}</td>
                        <td >{{ userInfo_form.visible }}</td>
                        <td ></td>
                    </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td>{{ info_formset.management_form }}</td>
                </tr>
            </tfoot>
        </table>






        {{ form.as_p }}


    </form>
    {#    <script type="text/javascript">addEvent(window, "load", function(e) { SelectFilter.init("id_subscripcions", "subscripcions", 0, "/media/"); });</script>#}

    <script>
        $('.userInfo_form').formset({
            addText: 'Añadir información personal',
            deleteText: 'Eliminar',
            added: function (row) {
                $(".etiquetes").select2({tags: true, allowClear: true, placeholder: "Etiqueta personal"});
            }

        });
    </script>

{% endblock %}